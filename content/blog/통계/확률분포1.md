---
title: 확률분포1
date: 2021-06-07 11:06:82
category: 통계
thumbnail: { thumbnailSrc }
draft: false
---

# 확률 분포
## 밀도 추정
* $N$개의 관찰데이터(observations) $x_1,...x_N$가 주어졌을 때 분포함수 $p(x)$ 를 찾는 것

1. $p(x)$를 파라미터화된 분포로 가정한다.

2. 분포의 파라미터를 찾는다.  
   * 빈도주의 방법  
    우도함수를 최적화시키는 과정을 통해 파라미터의 값을 정한다.

   * 베이지언 방법  
    파라미터의 사전확률을 가정하고, 베이즈 룰을 통해 파라미터의 사후확률을 구한다.
3. 파라미터를 사용하여 예측한다.(회귀 : 수치를 예측, 분류 : 클래스를 예측)

## 이항변수의 경우 : 빈도주의 방법

## 이항변수의 경우 : 베이지언 방법

### 이항분포
* $\mathbin{D} = \{x_1,...,x_N\}$ 일때 이항변수가 1인경우를 $m$번 관찰할 확률
$$
Bin(m|N,\mu) = \binom{N}{m}\mu^m(1-\mu)^{N-m}\\
\mathbb{E}[m] = \sum_{m=0}^NmBin(m|N,\mu) = N\mu\\
var[m] = \sum_{m=0}^N(m-\mathbb{E[m]})^2Bin(m|N,\mu) = N\mu(1-\mu)
$$

### 감마함수
* factorial을 복소수로 확장시킨 함수
$$
\Gamma (x) = \int_0^{\infty}u^{x-1}e^{-u}du
$$
* 양의정수에 대해서 $\Gamma(n) = (n-1)!$이 성립한다.
### 베타함수
* 아래와 같이 정의된다.
$$
B(x,y) = \int_0^1 t^{x-1}(1-t)^{y-1}dt \\
$$
* 감마함수의 비로도 나타낼 수 있다.
$$
B(x,y) = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)}
$$
* 또한 베타함수는 이항계수의 일반화로 생각할 수도 있다.
$$
\binom{n}{k} = \frac{1}{(n+1)B(n-k+1,k+1)}
$$

### 켤레사전분포(conjugate prior)
* 사전분포와 사후분포가 동일한 분포족에 속해있을때 사전분포를 켤레사전분포라고 한다.
* 사용하는 이유 : 계산이 편해진다.

### 베타분포(Beta Distribution)
* 베이지언 방법으로 문제를 해결하기 위해 베타분포를 켤레사전분포로 사용한다.
$$
Beta(\mu|a,b) = \frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\mu^{a-1}(1-\mu)^{b-1}
$$

* 기대값
$$
\mathbb{E}[\mu] = \frac{a}{a+b}
$$
* 분산
$$
var[\mu] =\frac{ab}{(a+b)^2(a+b+1)}
$$

* $\mu$ 의 사후확률  
  * 켤레사전분포인 베타함수의 형태가 같은 것을 알 수 있다.
$$
\begin{aligned}
p(\mu|m,l,a,b) &= \frac{Bin(m|N,\mu)Beta(\mu|a,b)}{\int_0^1Bin(m|N\mu)Beta(\mu|a,b)d\mu} \\
&= \frac{\mu^{m+a-1}(1-\mu^{l+b-1})}{\int_0^1\mu^{m+a-1}(1-\mu^{l+b-1})d\mu}\\
&= \frac{\mu^{m+a-1}(1-\mu^{l+b-1})}{\Gamma(m+a)\Gamma(l+b)/\Gamma(m+a+l+b)}\\  
&= \frac{\Gamma(m+a+l+b)}{\Gamma(m+a)\Gamma(l+b)}\mu^{m+a-1}(1-\mu^{l+b-1})
\end{aligned}\\
l = N-m
$$  

* 예측분포()
  * 사전분포와 사후분포 보두 베타분포의 형태를 띄고 있기때문에 사후분포를 새로운 사전분포로 사용하는것도 가능하다.
$$
p(x=1|D) = \int_0^1p(x=1|\mu)p(\mu|D)d\mu = \int_0^1\mu p(\mu|D)d\mu = \mathbb{E}[\mu|D]\\
$$  
* 베타분포의 기대값을 사후분포에 적용하면 다음과 같은 결과를 얻을 수 있다.
$$
p(x=1|D) = \frac{m+a}{m+a+l+b}
$$